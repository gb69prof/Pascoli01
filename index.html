<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pascoli ‚Äî Libro.0</title>
  <meta name="description" content="Pascoli ‚Äî web app didattica per autore. Pagina iniziale." />

  <style>
    :root{
      --bg:#0b0f14;
      --ink:rgba(255,255,255,0.92);
      --muted:rgba(255,255,255,0.72);
      --quiet:rgba(255,255,255,0.55);
      --line:rgba(255,255,255,0.12);
      --card:rgba(255,255,255,0.04);
      --accent:#caa86a;
      --shadow:0 18px 60px rgba(0,0,0,0.55);
      --r-xl:22px;
      --r-lg:16px;
      --max:1100px;
    }

    *{box-sizing:border-box;}
    html,body{height:100%;}
    body{
      margin:0;
      color:var(--ink);
      background:
        radial-gradient(1000px 520px at 50% -10%, rgba(202,168,106,0.12), transparent 60%),
        radial-gradient(800px 520px at 10% 40%, rgba(120,194,176,0.08), transparent 62%),
        linear-gradient(180deg, #070a0d, var(--bg));
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      letter-spacing:.2px;
    }

    a{color:inherit;text-decoration:none;}
    a:focus{outline:2px solid rgba(202,168,106,.55); outline-offset:2px; border-radius:12px;}

    .wrap{max-width:var(--max); margin:0 auto; padding:22px 18px 28px;}

    /* Phrase */
    .titleline{text-align:center; margin: 2px 0 16px;}
    .phrase{
      display:inline-block;
      font-weight:850;
      font-size:clamp(26px,4.8vw,48px);
      line-height:1.06;
      padding:10px 14px;
      border-radius:16px;
      border:1px solid transparent;
      cursor:pointer;
      user-select:none;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .phrase:hover{ transform: translateY(-1px); background:rgba(255,255,255,0.03); border-color: rgba(202,168,106,.22);}
    .phrase[contenteditable="true"]{ user-select:text; cursor:text; }

    .micro{margin-top:6px; font-size:12px; color:var(--quiet);}

    /* Cards */
    .card{
      border:1px solid var(--line);
      background:var(--card);
      border-radius:var(--r-xl);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:12px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.05), transparent);
    }
    .card .hd strong{
      font-size:12px;
      letter-spacing:.9px;
      text-transform:uppercase;
      color:rgba(255,255,255,0.82);
    }
    .card .bd{padding:14px;}

    /* Top split: image + philosophy */
    .topgrid{
      display:grid;
      grid-template-columns: 1fr 380px;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .topgrid{ grid-template-columns: 1fr; }
    }

    .stage{
      position:relative;
      min-height:520px;
      border-radius:var(--r-xl);
      border:1px solid rgba(255,255,255,0.14);
      overflow:hidden;
      background:
        linear-gradient(180deg, rgba(0,0,0,0.16), rgba(0,0,0,0.62)),
        url("assets/pascoli-foto.png") center/cover no-repeat;
    }

    .stage .hint{
      position:absolute;
      top:12px; left:12px;
      font-size:12px;
      color:rgba(255,255,255,0.72);
      background:rgba(0,0,0,0.45);
      border:1px solid rgba(255,255,255,0.14);
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }

    .stage .btn{
      position:absolute;
      bottom:16px;
      left:16px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.16);
      background:rgba(0,0,0,0.55);
      color:rgba(255,255,255,0.92);
      font-size:12px;
      font-weight:700;
      cursor:pointer;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .stage .btn:hover{ transform: translateY(-1px); background:rgba(0,0,0,0.62); border-color: rgba(202,168,106,.28); }

    /* Index row */
    .indexgrid{
      margin-top:16px;
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
    }

    .nav a{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:10px 10px;
      border-radius:14px;
      border:1px solid transparent;
      background:rgba(255,255,255,0.03);
      margin:8px 0;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .nav a:hover{ transform: translateY(-1px); background:rgba(255,255,255,0.055); border-color: rgba(202,168,106,.20); }
    .label{font-weight:760; font-size:13px;}
    .sub{font-size:12px; color:var(--quiet);}
    .chev{color:rgba(202,168,106,0.95); font-weight:900;}

    /* Modal */
    .modal[hidden]{display:none;}
    .modal{
      position:fixed;
      inset:0;
      z-index:100;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .backdrop{position:absolute; inset:0; background:rgba(0,0,0,0.72);}
    .dialog{
      position:relative;
      width:100%;
      max-width:880px;
      border-radius:var(--r-xl);
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(7,10,13,0.88);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .dialog .dh{
      padding:12px 14px 10px;
      border-bottom:1px solid rgba(255,255,255,0.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), transparent);
    }
    .dialog .dh strong{
      font-size:12px; letter-spacing:.9px; text-transform:uppercase; color:rgba(255,255,255,0.82);
    }
    .x{
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.05);
      color:rgba(255,255,255,0.90);
      border-radius:12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:800;
    }
    .dialog .db{padding:14px 16px 16px;}
    .dialog h3{margin:0; font-size:18px; font-weight:900;}
    .dialog p{margin:10px 0 0; color:rgba(255,255,255,0.82); line-height:1.65; font-size:14px;}
    .dialog ul{margin:10px 0 0; padding-left:18px; color:rgba(255,255,255,0.80); line-height:1.65; font-size:14px;}
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;}
    .linkbtn{
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.05);
      color:rgba(255,255,255,0.92);
      font-size:12px;
      font-weight:750;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .linkbtn:hover{ transform: translateY(-1px); background:rgba(255,255,255,0.07); border-color: rgba(202,168,106,.28); }

    footer{margin-top:16px; font-size:12px; color:var(--quiet);}
    @media (prefers-reduced-motion: reduce){ *{transition:none !important;} }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- Phrase (editable + bussola) -->
    <div class="titleline">
      <div id="phrase" class="phrase" contenteditable="true" spellcheck="false"
           title="Puoi modificare la frase. Clicca per aprire la bussola.">
        Io non sono mai cresciuto
      </div>
      <div class="micro">Puoi modificarla. Clic per leggere il significato (bussola).</div>
    </div>

    <!-- TOP: image + philosophy -->
    <section class="topgrid" aria-label="Home Pascoli">
      <div class="stage" role="img" aria-label="Pascoli (immagine)">
        <div class="hint">clic: eco di Pascoli</div>
        <button id="openEcho" class="btn" type="button">Ascolta l‚Äôeco di Pascoli</button>
      </div>

      <aside class="card" aria-label="Filosofia del libro">
        <div class="hd"><strong>Filosofia di questo libro</strong></div>
        <div class="bd">
          <p style="margin:0; color:rgba(255,255,255,0.82); line-height:1.6; font-size:13px;">
            Questa non √® una lezione-museo. √à un percorso attraversabile.
            Qui trovi ci√≤ che serve per capire Pascoli senza perderti, e spazi per lavorare davvero.
          </p>
          <p style="margin:10px 0 0; color:rgba(255,255,255,0.78); line-height:1.6; font-size:13px;">
            Non tutto √® obbligatorio: la profondit√† √® una tua scelta.
            Il nostro compito √® farti vedere dove sei, cosa stai facendo, e dove puoi andare.
          </p>
          <p style="margin:10px 0 0; color:rgba(255,255,255,0.78); line-height:1.6; font-size:13px;">
            Il percorso √® semplice: <b>Vita</b> ‚Üí <b>Immagine del mondo</b> ‚Üí <b>Poetica</b> ‚Üí <b>Testi</b>.
            Gli approfondimenti arrivano dopo, quando servono.
          </p>
        </div>
      </aside>
    </section>

    <!-- INDEX -->
    <section class="indexgrid" aria-label="Indice della web app" style="margin-top:16px;">
      <div class="card nav">
        <div class="hd"><strong>Indice</strong></div>
        <div class="bd">
          <a href="vita.html">
            <div><div class="label">1. La vita</div><div class="sub">sintesi + pagine collegate</div></div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="mondo.html">
            <div><div class="label">2. L‚Äôimmagine del mondo</div><div class="sub">segni, presagi, realt√† instabile</div></div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="poetica.html">
            <div><div class="label">3. La poetica</div><div class="sub">fanciullino, forma, lingua</div></div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="testi/gelsomino-notturno.html">
            <div><div class="label">4. I testi ‚Äî Il gelsomino notturno</div><div class="sub">pagina + lavoro sul testo</div></div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="testi/x-agosto.html">
            <div><div class="label">4. I testi ‚Äî X agosto</div><div class="sub">pagina + lavoro sul testo</div></div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="testi/digitale-purpurea.html">
            <div><div class="label">4. I testi ‚Äî Digitale purpurea</div><div class="sub">pagina + lavoro sul testo</div></div>
            <div class="chev">‚Ä∫</div>
          </a>
        </div>
      </div>
    </section>

    <footer>¬© <span id="year"></span> ‚Äî Pascoli / Libro.0 ‚Äî a cura di gbprof</footer>
  </div>

  <!-- MODAL: Bussola della frase -->
  <div id="modalBussola" class="modal" hidden aria-hidden="true">
    <div class="backdrop" data-close="bussola"></div>
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="bussolaTitle">
      <div class="dh">
        <strong>Bussola</strong>
        <button class="x" data-close="bussola" type="button" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="db">
        <h3 id="bussolaTitle">Io non sono mai cresciuto</h3>
        <p>
          Qui ‚Äúnon crescere‚Äù non significa restare bambini. Significa restare <b>esposti</b>:
          non imparare davvero a difendersi dal mondo.
          In Pascoli le cose diventano segni: un rumore, un fiore, una notte.
        </p>
        <ul>
          <li>Il <b>fanciullino</b> non √® tenerezza: √® percezione senza difese.</li>
          <li>La poesia non consola: fa vedere ci√≤ che di solito resta sotto.</li>
          <li>La forma (frasi brevi, accostate) non √® un gioco: √® necessit√†.</li>
        </ul>
        <p>Questa frase √® la bussola del percorso: <b>Vita</b> ‚Üí <b>Mondo</b> ‚Üí <b>Poetica</b> ‚Üí <b>Testi</b>.</p>
        <div class="row">
          <a class="linkbtn" href="vita.html">Vai a ‚ÄúLa vita‚Äù</a>
          <a class="linkbtn" href="mondo.html">Vai a ‚ÄúImmagine del mondo‚Äù</a>
          <a class="linkbtn" href="poetica.html">Vai a ‚ÄúPoetica‚Äù</a>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL: Eco di Pascoli (segnaposto: testo + voce browser, opzionale) -->
  <div id="modalEco" class="modal" hidden aria-hidden="true">
    <div class="backdrop" data-close="eco"></div>
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="ecoTitle">
      <div class="dh">
        <strong id="ecoTitle">Eco di Pascoli</strong>
        <button class="x" data-close="eco" type="button" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="db">
        <p style="margin-top:0;">
          Io sono l‚Äôeco di Giovanni Pascoli. Non sono il poeta della quiete.
          Sono il poeta di un mondo che scricchiola: segni, suoni, fratture.
          Il fanciullino, in me, non √® una favola: √® uno sguardo che trema e vede.
        </p>
        <p>
          Se ti sembra semplice, √® perch√© la mia lingua √® costretta: frasi brevi, immagini accostate,
          silenzi. Non per ‚Äústile‚Äù, ma per necessit√†.
        </p>
        <div class="row">
          <button class="linkbtn" id="btnSpeak" type="button">üîä Voce</button>
          <button class="linkbtn" id="btnStop" type="button">‚èπ Stop</button>
        </div>
        <p style="margin-top:10px; font-size:12px; color:rgba(255,255,255,0.62);">
          Nota: la voce usa il browser (SpeechSynthesis). Se non disponibile, resta il testo.
        </p>
      </div>
    </div>
  </div>

  <script>
    const phrase = document.getElementById('phrase');

    // Persist phrase
    const KEY = 'pascoli_home_phrase_v2';
    const saved = localStorage.getItem(KEY);
    if(saved && saved.trim()) phrase.textContent = saved;

    const savePhrase = () => {
      const t = (phrase.textContent || '').trim();
      if(t) localStorage.setItem(KEY, t);
    };
    phrase.addEventListener('input', savePhrase);
    phrase.addEventListener('blur', savePhrase);

    // Modals
    const modalB = document.getElementById('modalBussola');
    const modalE = document.getElementById('modalEco');

    const open = (m) => { m.hidden = false; m.setAttribute('aria-hidden','false'); };
    const close = (m) => { m.hidden = true; m.setAttribute('aria-hidden','true'); };

    // Title inside bussola follows edited phrase
    const bussolaTitle = document.getElementById('bussolaTitle');
    const openBussola = () => {
      const t = (phrase.textContent || '').trim();
      bussolaTitle.textContent = t || 'Io non sono mai cresciuto';
      open(modalB);
    };

    // click opens bussola when not selecting text
    let editing = false;
    phrase.addEventListener('focus', ()=> editing = true);
    phrase.addEventListener('blur',  ()=> editing = false);

    phrase.addEventListener('click', () => {
      if(editing) return;
      const sel = window.getSelection();
      if(sel && sel.toString().length > 0) return;
      openBussola();
    });
    phrase.addEventListener('dblclick', (e)=>{ e.preventDefault(); openBussola(); });

    document.getElementById('openEcho').addEventListener('click', ()=> open(modalE));

    document.querySelectorAll('[data-close="bussola"]').forEach(el => el.addEventListener('click', ()=> close(modalB)));
    document.querySelectorAll('[data-close="eco"]').forEach(el => el.addEventListener('click', ()=> { stopSpeak(); close(modalE); }));

    document.addEventListener('keydown', (e)=>{
      if(e.key !== 'Escape') return;
      if(!modalE.hidden) { stopSpeak(); close(modalE); }
      else if(!modalB.hidden) close(modalB);
    });

    // Optional voice
    const btnSpeak = document.getElementById('btnSpeak');
    const btnStop  = document.getElementById('btnStop');

    const canSpeak = () => ('speechSynthesis' in window) && typeof SpeechSynthesisUtterance !== 'undefined';
    const stopSpeak = () => { if(canSpeak()) window.speechSynthesis.cancel(); };

    const doSpeak = () => {
      if(!canSpeak()) return;
      stopSpeak();
      const text = Array.from(modalE.querySelectorAll('.db p')).map(p=>p.textContent.trim()).join(' ');
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'it-IT';
      u.rate = 0.95;
      window.speechSynthesis.speak(u);
    };

    btnSpeak.addEventListener('click', doSpeak);
    btnStop.addEventListener('click', stopSpeak);

    if(!canSpeak()){
      btnSpeak.textContent = 'üîä Voce (non disponibile)';
      btnSpeak.style.opacity = 0.55;
      btnSpeak.style.cursor = 'not-allowed';
      btnSpeak.disabled = true;
    }

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
