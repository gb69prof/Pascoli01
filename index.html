<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pascoli — Libro.0</title>
  <meta name="description" content="Pascoli — web app didattica per autore. Pagina iniziale." />

  <style>
    :root{
      /* Palette più viva (fanciullino): carta chiara + cielo + giallo caldo */
      --bg1:#fbf7ef;        /* carta */
      --bg2:#e9f6ff;        /* cielo */
      --ink:#1f2a33;        /* inchiostro */
      --muted:rgba(31,42,51,0.72);
      --quiet:rgba(31,42,51,0.56);
      --line:rgba(31,42,51,0.14);
      --card:rgba(255,255,255,0.70);
      --card2:rgba(255,255,255,0.86);
      --accent:#ffb703;     /* giallo caldo */
      --accent2:#219ebc;    /* azzurro */
      --shadow:0 18px 60px rgba(0,0,0,0.14);
      --r-xl:22px;
      --r-lg:16px;
      --max:1120px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      background:
        radial-gradient(900px 520px at 20% 10%, rgba(33,158,188,0.18), transparent 62%),
        radial-gradient(820px 520px at 80% 18%, rgba(255,183,3,0.20), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg1));
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      letter-spacing: .2px;
    }

    a{ color:inherit; text-decoration:none; }
    a:focus{ outline: 2px solid rgba(33,158,188,0.55); outline-offset: 2px; border-radius: 12px; }

    .wrap{ max-width: var(--max); margin: 0 auto; padding: 22px 18px 28px; }

    /* Frase */
    .titleline{ text-align:center; margin: 2px 0 16px; }
    .phrase{
      display:inline-block;
      font-weight: 900;
      font-size: clamp(26px, 4.8vw, 50px);
      line-height: 1.06;
      padding: 10px 14px;
      border-radius: 18px;
      border: 1px solid transparent;
      cursor: pointer;
      user-select:none;
      background: rgba(255,255,255,0.55);
      transition: transform .14s ease, border-color .14s ease, background .14s ease;
    }
    .phrase:hover{
      transform: translateY(-1px);
      border-color: rgba(255,183,3,0.55);
      background: rgba(255,255,255,0.80);
    }
    .phrase[contenteditable="true"]{ user-select:text; cursor:text; }
    .micro{ margin-top: 6px; font-size: 12px; color: var(--quiet); }

    /* Cards */
    .card{
      border: 1px solid var(--line);
      background: var(--card);
      border-radius: var(--r-xl);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .card .hd{
      padding: 12px 14px 10px;
      border-bottom: 1px solid rgba(31,42,51,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.65), rgba(255,255,255,0.20));
    }
    .card .hd strong{
      font-size: 12px;
      letter-spacing: .9px;
      text-transform: uppercase;
      color: rgba(31,42,51,0.76);
    }
    .card .bd{ padding: 14px; }

    /* TOP: immagine/video + filosofia */
    .topgrid{
      display:grid;
      grid-template-columns: 1fr 390px;
      gap: 16px;
      align-items: stretch;
    }
    @media (max-width: 980px){
      .topgrid{ grid-template-columns: 1fr; }
    }

    .stage{
      position: relative;
      min-height: 520px;
      border-radius: var(--r-xl);
      border: 1px solid rgba(31,42,51,0.14);
      overflow: hidden;
      background:
        radial-gradient(700px 340px at 30% 40%, rgba(255,183,3,0.16), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,0.55), rgba(255,255,255,0.18));
    }

    .stageInner{
      position:absolute;
      inset:0;
      display:flex;
      align-items:stretch;
      justify-content:stretch;
    }

    /* FOTO */
    .portrait{
      width:100%;
      height:100%;
      display:flex;
      align-items:stretch;
      justify-content:stretch;
      cursor:pointer;
      background:
        linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.20)),
        url("assets/pascoli-foto.png") center/cover no-repeat;
    }

    .hint{
      position:absolute;
      top:12px;
      left:12px;
      font-size: 12px;
      color: rgba(31,42,51,0.72);
      background: rgba(255,255,255,0.78);
      border: 1px solid rgba(31,42,51,0.12);
      padding: 6px 10px;
      border-radius: 999px;
    }

    .cta{
      position:absolute;
      bottom: 14px;
      left: 14px;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(31,42,51,0.14);
      background: rgba(255,255,255,0.82);
      font-size: 12px;
      font-weight: 800;
      cursor:pointer;
      user-select:none;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .cta:hover{ transform: translateY(-1px); border-color: rgba(33,158,188,0.45); background: rgba(255,255,255,0.92); }

    /* VIDEO */
    .videoWrap{
      width:100%;
      height:100%;
      background: #ffffff;
      display:flex;
      align-items:stretch;
      justify-content:stretch;
    }
    .videoWrap iframe{
      width:100%;
      height:100%;
      border:0;
      display:block;
    }

    .backToPhoto{
      position:absolute;
      top:12px;
      right:12px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(31,42,51,0.14);
      background: rgba(255,255,255,0.86);
      font-size: 12px;
      font-weight: 800;
      cursor:pointer;
      user-select:none;
      display:none;
    }

    /* Indice */
    .indexgrid{ margin-top: 16px; }
    .nav a{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid transparent;
      background: rgba(255,255,255,0.70);
      margin: 8px 0;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .nav a:hover{ transform: translateY(-1px); border-color: rgba(255,183,3,0.45); background: rgba(255,255,255,0.92); }
    .label{ font-weight: 850; font-size: 13px; }
    .sub{ color: var(--quiet); font-size: 12px; }
    .chev{ color: rgba(33,158,188,0.95); font-weight: 900; }

    footer{ margin-top: 16px; font-size: 12px; color: var(--quiet); }

    /* MODAL bussola */
    .modal[hidden]{ display:none; }
    .modal{
      position: fixed;
      inset: 0;
      z-index: 100;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .backdrop{ position:absolute; inset:0; background: rgba(0,0,0,0.40); }
    .dialog{
      position: relative;
      width: 100%;
      max-width: 900px;
      border-radius: var(--r-xl);
      border: 1px solid rgba(31,42,51,0.16);
      background: rgba(255,255,255,0.92);
      box-shadow: 0 18px 60px rgba(0,0,0,0.18);
      overflow:hidden;
    }
    .dialog .dh{
      padding: 12px 14px 10px;
      border-bottom: 1px solid rgba(31,42,51,0.12);
      display:flex;
      align-items:center;
      justify-content:space-between;
      background: linear-gradient(180deg, rgba(255,183,3,0.22), transparent);
    }
    .dialog .dh strong{ font-size: 12px; letter-spacing:.9px; text-transform: uppercase; color: rgba(31,42,51,0.72); }
    .x{
      border: 1px solid rgba(31,42,51,0.14);
      background: rgba(255,255,255,0.80);
      color: rgba(31,42,51,0.90);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 900;
    }
    .dialog .db{ padding: 14px 16px 16px; }
    .dialog h3{ margin:0; font-size: 18px; font-weight: 950; }
    .dialog p{ margin: 10px 0 0; line-height: 1.65; font-size: 14px; color: rgba(31,42,51,0.86); }
    .dialog ul{ margin: 10px 0 0; padding-left: 18px; line-height: 1.65; font-size: 14px; color: rgba(31,42,51,0.86); }
    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 14px; }
    .linkbtn{
      display:inline-flex; align-items:center; gap: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(31,42,51,0.14);
      background: rgba(255,255,255,0.92);
      font-size: 12px;
      font-weight: 850;
    }

    @media (prefers-reduced-motion: reduce){ *{ transition:none !important; } }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- Frase (editabile + bussola) -->
    <div class="titleline">
      <div id="phrase" class="phrase" contenteditable="true" spellcheck="false"
           title="Puoi modificare la frase. Clicca per aprire la bussola.">
        Io non sono mai cresciuto
      </div>
      <div class="micro">Puoi modificarla. Clic per leggerne il significato (bussola).</div>
    </div>

    <!-- TOP: FOTO/VIDEO + FILOSOFIA -->
    <section class="topgrid" aria-label="Home Pascoli">

      <!-- Stage: foto -> video (clic) -->
      <div class="stage" aria-label="Pascoli (foto o video)">
        <div class="hint" id="hint">clic sulla foto: eco di Pascoli</div>
        <div class="stageInner" id="stageInner">
          <!-- FOTO (cliccabile) -->
          <div class="portrait" id="portrait" role="img" aria-label="Foto di Pascoli"></div>
        </div>
        <button class="cta" id="cta" type="button">▶︎ Guarda l’eco di Pascoli</button>
        <button class="backToPhoto" id="backToPhoto" type="button">↩︎ Torna alla foto</button>
      </div>

      <!-- Filosofia -->
      <aside class="card" aria-label="Filosofia del libro">
        <div class="hd"><strong>Filosofia di questo libro</strong></div>
        <div class="bd">
          <p style="margin:0; line-height:1.6; font-size:13px; color:rgba(31,42,51,0.86);">
            Questa web app non è una lezione-museo. È un percorso attraversabile.
            Qui trovi ciò che serve per capire Pascoli senza perderti, e spazi per lavorare davvero.
          </p>
          <p style="margin:10px 0 0; line-height:1.6; font-size:13px; color:rgba(31,42,51,0.82);">
            Non tutto è obbligatorio: la profondità è una tua scelta.
            Il nostro compito è farti vedere dove sei, cosa stai facendo, e dove puoi andare.
          </p>
          <p style="margin:10px 0 0; line-height:1.6; font-size:13px; color:rgba(31,42,51,0.82);">
            Percorso essenziale: <b>Vita</b> → <b>Immagine del mondo</b> → <b>Poetica</b> → <b>Testi</b>.
            Gli approfondimenti arrivano dopo, quando servono.
          </p>
        </div>
      </aside>

    </section>

    <!-- Indice -->
    <section class="indexgrid" aria-label="Indice della web app">
      <div class="card nav">
        <div class="hd"><strong>Indice</strong></div>
        <div class="bd">
          <a href="vita.html">
            <div>
              <div class="label">1. La vita</div>
              <div class="sub">sintesi + pagine collegate</div>
            </div>
            <div class="chev">›</div>
          </a>

          <a href="mondo.html">
            <div>
              <div class="label">2. L’immagine del mondo</div>
              <div class="sub">segni, presagi, realtà instabile</div>
            </div>
            <div class="chev">›</div>
          </a>

          <a href="poetica.html">
            <div>
              <div class="label">3. La poetica</div>
              <div class="sub">fanciullino, forma, lingua</div>
            </div>
            <div class="chev">›</div>
          </a>

          <a href="testi/gelsomino-notturno.html">
            <div>
              <div class="label">4. I testi — Il gelsomino notturno</div>
              <div class="sub">pagina + lavoro sul testo</div>
            </div>
            <div class="chev">›</div>
          </a>

          <a href="testi/x-agosto.html">
            <div>
              <div class="label">4. I testi — X agosto</div>
              <div class="sub">pagina + lavoro sul testo</div>
            </div>
            <div class="chev">›</div>
          </a>

          <a href="testi/digitale-purpurea.html">
            <div>
              <div class="label">4. I testi — Digitale purpurea</div>
              <div class="sub">pagina + lavoro sul testo</div>
            </div>
            <div class="chev">›</div>
          </a>
        </div>
      </div>
    </section>

    <footer>© <span id="year"></span> — Pascoli / Libro.0 — a cura di gbprof</footer>
  </div>

  <!-- MODAL: Bussola della frase -->
  <div id="modalBussola" class="modal" hidden aria-hidden="true">
    <div class="backdrop" data-close="bussola"></div>
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="bussolaTitle">
      <div class="dh">
        <strong>Bussola</strong>
        <button class="x" data-close="bussola" type="button" aria-label="Chiudi">✕</button>
      </div>
      <div class="db">
        <h3 id="bussolaTitle">Io non sono mai cresciuto</h3>
        <p>
          Qui “non crescere” non significa restare bambini. Significa restare <b>esposti</b>:
          non imparare davvero a difendersi dal mondo.
          In Pascoli le cose diventano segni: un rumore, un fiore, una notte.
        </p>
        <ul>
          <li>Il <b>fanciullino</b> non è tenerezza: è percezione senza difese.</li>
          <li>La poesia non consola: fa vedere ciò che di solito resta sotto.</li>
          <li>La forma (frasi brevi, accostate) non è un gioco: è necessità.</li>
        </ul>
        <p>Questa frase è la bussola del percorso: <b>Vita</b> → <b>Mondo</b> → <b>Poetica</b> → <b>Testi</b>.</p>
        <div class="row">
          <a class="linkbtn" href="vita.html">Vai a “La vita”</a>
          <a class="linkbtn" href="mondo.html">Vai a “Immagine del mondo”</a>
          <a class="linkbtn" href="poetica.html">Vai a “Poetica”</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const $ = (q, r=document) => r.querySelector(q);

    // Year
    $('#year').textContent = new Date().getFullYear();

    // Phrase persistence
    const phrase = $('#phrase');
    const KEY = 'pascoli_home_phrase_v3';
    const saved = localStorage.getItem(KEY);
    if(saved && saved.trim()) phrase.textContent = saved;

    const savePhrase = () => {
      const t = (phrase.textContent || '').trim();
      if(t) localStorage.setItem(KEY, t);
    };
    phrase.addEventListener('input', savePhrase);
    phrase.addEventListener('blur', savePhrase);

    // Bussola modal
    const modalB = $('#modalBussola');
    const bussolaTitle = $('#bussolaTitle');
    const openBussola = () => {
      const t = (phrase.textContent || '').trim();
      bussolaTitle.textContent = t || 'Io non sono mai cresciuto';
      modalB.hidden = false;
      modalB.setAttribute('aria-hidden','false');
    };
    const closeBussola = () => {
      modalB.hidden = true;
      modalB.setAttribute('aria-hidden','true');
    };

    // contenteditable: non aprire bussola mentre selezioni testo
    let editing = false;
    phrase.addEventListener('focus', ()=> editing = true);
    phrase.addEventListener('blur',  ()=> editing = false);

    phrase.addEventListener('click', () => {
      if(editing) return;
      const sel = window.getSelection();
      if(sel && sel.toString().length > 0) return;
      openBussola();
    });
    phrase.addEventListener('dblclick', (e)=>{ e.preventDefault(); openBussola(); });

    document.querySelectorAll('[data-close="bussola"]').forEach(el => el.addEventListener('click', closeBussola));
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && !modalB.hidden) closeBussola(); });

    // Foto -> Video (HeyGen)
    const stageInner = $('#stageInner');
    const cta = $('#cta');
    const hint = $('#hint');
    const backToPhoto = $('#backToPhoto');

    const heygenIframe = `
      <div class="videoWrap" id="videoWrap">
        <iframe
          src="https://app.heygen.com/embedded-player/e5c1a51af56e43589b800ebb00cb1507"
          title="HeyGen video player"
          frameborder="0"
          allow="encrypted-media; fullscreen;"
          allowfullscreen
        ></iframe>
      </div>`;

    let showingVideo = false;

    function showVideo(){
      if(showingVideo) return;
      stageInner.innerHTML = heygenIframe;
      showingVideo = true;
      cta.style.display = 'none';
      hint.textContent = 'video: eco di Pascoli';
      backToPhoto.style.display = 'inline-flex';
    }

    function showPhoto(){
      if(!showingVideo) return;
      stageInner.innerHTML = '<div class="portrait" id="portrait" role="img" aria-label="Foto di Pascoli"></div>';
      showingVideo = false;
      cta.style.display = 'inline-flex';
      hint.textContent = 'clic sulla foto: eco di Pascoli';
      backToPhoto.style.display = 'none';

      // re-bind click for new portrait node
      $('#portrait').addEventListener('click', showVideo);
    }

    // initial bindings
    $('#portrait').addEventListener('click', showVideo);
    cta.addEventListener('click', showVideo);
    backToPhoto.addEventListener('click', showPhoto);
  </script>
</body>
</html>

