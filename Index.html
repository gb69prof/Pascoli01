<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pascoli ‚Äî Home</title>
  <meta name="description" content="Home essenziale della web app Pascoli (Libro.0)." />

  <!--
    PASCOLI / INDEX MINIMAL
    Obiettivo: essenziale, solo cosa si trova nella web app (niente livelli qui).
    Requisiti:
    - Immagine cliccabile: alterna Ritratto ‚Üî Eco di Pascoli (testo/voce)
    - Frase 'Io non sono mai cresciuto' editabile; click = spiegazione (bussola)
    - Indice con link alle pagine: vita, mondo, poetica, testi...
    - Spirito dell‚Äôopera (breve) in fondo.

    NOTE:
    - Inserisci una foto in: assets/pascoli.jpg
    - Crea poi le pagine linkate (anche vuote per ora).
  -->

  <style>
    :root{
      /* Pascoli: notte, carta, rame. Essenziale. */
      --bg: #0b0f14;
      --ink: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --quiet: rgba(255,255,255,0.52);
      --line: rgba(255,255,255,0.12);
      --card: rgba(255,255,255,0.04);
      --card2: rgba(255,255,255,0.06);
      --accent: #caa86a;   /* rame */
      --accent2:#78c2b0;   /* verde acqua tenue */
      --shadow: 0 18px 60px rgba(0,0,0,0.55);
      --r-xl: 22px;
      --r-lg: 16px;
      --max: 1080px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      background:
        radial-gradient(1000px 520px at 50% -10%, rgba(202,168,106,0.12), transparent 60%),
        radial-gradient(820px 520px at 12% 30%, rgba(120,194,176,0.08), transparent 62%),
        linear-gradient(180deg, #070a0d, var(--bg));
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      letter-spacing: 0.2px;
    }

    a{ color:inherit; text-decoration:none; }
    a:focus{ outline: 2px solid rgba(202,168,106,0.55); outline-offset: 2px; border-radius: 10px; }

    .wrap{ max-width: var(--max); margin: 0 auto; padding: 22px 18px 28px; }

    /* Title line (editable + clickable) */
    .top{
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding: 6px 0 16px;
    }

    .titleline{
      position: relative;
      max-width: 860px;
      width:100%;
      text-align:center;
    }

    .phrase{
      display:inline-block;
      font-weight: 860;
      font-size: clamp(26px, 4.6vw, 48px);
      line-height: 1.05;
      letter-spacing: 0.4px;
      padding: 10px 14px;
      border-radius: 16px;
      border: 1px solid transparent;
      background: transparent;
      cursor: pointer;
      user-select:none;
      transition: transform .14s ease, border-color .14s ease, background .14s ease;
    }

    .phrase:hover{
      transform: translateY(-1px);
      border-color: rgba(202,168,106,0.28);
      background: rgba(255,255,255,0.03);
    }

    .phrase[contenteditable="true"]{
      user-select:text;
      cursor:text;
    }

    .micro{
      margin-top: 8px;
      font-size: 12px;
      color: var(--quiet);
      line-height: 1.45;
    }

    .micro .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      padding: 2px 6px;
      border: 1px solid rgba(255,255,255,0.14);
      border-radius: 8px;
      background: rgba(255,255,255,0.03);
      color: rgba(255,255,255,0.78);
    }

    /* Main layout */
    .grid{
      display:grid;
      grid-template-columns: 260px 1fr;
      gap: 16px;
      align-items:start;
    }

    @media (max-width: 920px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border: 1px solid var(--line);
      background: var(--card);
      border-radius: var(--r-xl);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .card .hd{
      padding: 12px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), transparent);
    }

    .card .hd h2{
      margin:0;
      font-size: 12px;
      letter-spacing: 0.9px;
      text-transform: uppercase;
      color: rgba(255,255,255,0.82);
    }

    .card .bd{ padding: 14px; }

    /* Index list */
    .nav a{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 10px 10px;
      border-radius: 14px;
      border: 1px solid transparent;
      background: rgba(255,255,255,0.03);
      margin: 8px 0;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .nav a:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.055); border-color: rgba(202,168,106,0.25); }

    .nav .label{ font-weight: 760; font-size: 13px; }
    .nav .sub{ color: var(--quiet); font-size: 12px; }
    .nav .chev{ color: rgba(202,168,106,0.95); font-weight: 900; }

    .nav .indent{ margin-left: 10px; padding-left: 10px; border-left: 1px dashed rgba(255,255,255,0.18); }

    /* Stage (image ‚Üî echo) */
    .stage{
      position: relative;
      border-radius: var(--r-xl);
      border: 1px solid rgba(255,255,255,0.14);
      overflow:hidden;
      min-height: 520px;
      background: rgba(255,255,255,0.02);
    }

    .stage .hint{
      position:absolute;
      top: 12px;
      right: 12px;
      font-size: 12px;
      color: rgba(255,255,255,0.72);
      background: rgba(7,10,13,0.55);
      border: 1px solid rgba(255,255,255,0.14);
      padding: 6px 10px;
      border-radius: 999px;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
      z-index: 5;
    }

    .panel{
      position:absolute;
      inset:0;
      display:flex;
      flex-direction:column;
      transition: opacity .20s ease;
    }

    .panel.hidden{ opacity: 0; pointer-events:none; }

    /* Portrait panel */
    .portrait{
      background:
        linear-gradient(180deg, rgba(0,0,0,0.12), rgba(0,0,0,0.60)),
        radial-gradient(700px 340px at 30% 40%, rgba(202,168,106,0.15), transparent 60%),
        url("assets/pascoli.jpg");
      background-size: cover;
      background-position:center;
    }

    .portrait .overlay{
      margin-top:auto;
      padding: 18px;
    }

    .portrait .overlay .btn{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(7,10,13,0.55);
      color: rgba(255,255,255,0.92);
      font-size: 12px;
      font-weight: 700;
      cursor:pointer;
      user-select:none;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .portrait .overlay .btn:hover{ transform: translateY(-1px); border-color: rgba(120,194,176,0.30); background: rgba(7,10,13,0.62); }

    .portrait .overlay .note{
      margin-top: 10px;
      color: rgba(255,255,255,0.72);
      font-size: 12px;
      line-height: 1.45;
      max-width: 760px;
    }

    /* Echo panel */
    .echo{
      background:
        radial-gradient(800px 520px at 20% 30%, rgba(120,194,176,0.10), transparent 62%),
        radial-gradient(900px 520px at 80% 40%, rgba(202,168,106,0.12), transparent 65%),
        linear-gradient(180deg, rgba(7,10,13,0.55), rgba(7,10,13,0.82));
      padding: 18px;
    }

    .echo .frame{
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.04);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.45);
      max-width: 840px;
    }

    .echo h3{
      margin: 0;
      font-size: 12px;
      letter-spacing: 0.9px;
      text-transform: uppercase;
      color: rgba(255,255,255,0.78);
    }

    .echo .who{
      margin: 8px 0 0;
      font-size: 18px;
      font-weight: 860;
      letter-spacing: 0.2px;
      color: rgba(255,255,255,0.92);
    }

    .echo p{
      margin: 10px 0 0;
      font-size: 14px;
      line-height: 1.65;
      color: rgba(255,255,255,0.82);
    }

    .echo .tools{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }

    .pillbtn{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 9px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.05);
      color: rgba(255,255,255,0.90);
      font-size: 12px;
      font-weight: 700;
      cursor:pointer;
      user-select:none;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .pillbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.07); border-color: rgba(202,168,106,0.35); }

    .smallprint{ margin-top: 10px; font-size: 12px; color: var(--quiet); line-height: 1.45; }

    /* Spirit */
    .spirit{
      margin-top: 16px;
      border: 1px solid rgba(255,255,255,0.10);
      border-radius: var(--r-xl);
      background: rgba(255,255,255,0.03);
      padding: 14px 16px;
    }
    .spirit h4{ margin:0; font-size: 12px; letter-spacing: 0.9px; text-transform: uppercase; color: rgba(255,255,255,0.78); }
    .spirit p{ margin: 10px 0 0; color: rgba(255,255,255,0.78); line-height: 1.6; font-size: 13px; }

    footer{ margin-top: 14px; color: rgba(255,255,255,0.55); font-size: 12px; padding: 10px 2px 0; }

    /* Modal (bussola frase) */
    .modal[hidden]{ display:none; }
    .modal{
      position:fixed;
      inset:0;
      z-index: 100;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }

    .backdrop{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,0.72);
    }

    .dialog{
      position:relative;
      width: 100%;
      max-width: 860px;
      border-radius: var(--r-xl);
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(7,10,13,0.85);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .dialog .dh{
      padding: 12px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,0.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.05), transparent);
    }

    .dialog .dh strong{ font-size: 12px; letter-spacing: 0.9px; text-transform: uppercase; color: rgba(255,255,255,0.82); }

    .x{
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.05);
      color: rgba(255,255,255,0.90);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
    }

    .dialog .db{ padding: 14px 16px 16px; }

    .dialog h3{ margin: 0; font-size: 18px; font-weight: 900; letter-spacing: 0.2px; }
    .dialog p{ margin: 10px 0 0; color: rgba(255,255,255,0.82); line-height: 1.65; font-size: 14px; }
    .dialog ul{ margin: 10px 0 0; padding-left: 18px; color: rgba(255,255,255,0.80); line-height: 1.65; font-size: 14px; }

    .dialog .row{ display:flex; gap: 10px; flex-wrap: wrap; margin-top: 14px; }

    .linkbtn{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(255,255,255,0.05);
      color: rgba(255,255,255,0.92);
      font-size: 12px;
      font-weight: 750;
      transition: transform .14s ease, background .14s ease, border-color .14s ease;
    }
    .linkbtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.07); border-color: rgba(202,168,106,0.35); }

    /* reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior:auto !important; transition:none !important; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- TOP / Editable phrase -->
    <div class="top">
      <div class="titleline">
        <div id="phrase" class="phrase" contenteditable="true" spellcheck="false" title="Puoi modificare questa frase. Clicca per aprire la bussola.">
          Io non sono mai cresciuto
        </div>
        <div class="micro">
          Modifica la frase se vuoi, poi <span class="kbd">clic</span> per aprire la bussola.
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- LEFT / INDEX -->
      <aside class="card nav" aria-label="Indice">
        <div class="hd"><h2>Indice</h2></div>
        <div class="bd">
          <a href="vita.html" aria-label="Vai a La vita">
            <div>
              <div class="label">La vita</div>
              <div class="sub">sintesi essenziale</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="mondo.html" aria-label="Vai a L‚Äôimmagine del mondo">
            <div>
              <div class="label">L‚Äôimmagine del mondo</div>
              <div class="sub">segni, presagi, instabilit√†</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="poetica.html" aria-label="Vai a La poetica">
            <div>
              <div class="label">La poetica</div>
              <div class="sub">fanciullino, forma, lingua</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <div class="indent" aria-label="Sotto-pagine poetica">
            <a href="poetica.html#fanciullino" aria-label="Vai a Il fanciullino">
              <div>
                <div class="label">Il fanciullino</div>
                <div class="sub">non tenero: esposto</div>
              </div>
              <div class="chev">‚Ä∫</div>
            </a>
            <a href="poetica.html#forma" aria-label="Vai a La forma">
              <div>
                <div class="label">La forma</div>
                <div class="sub">paratassi, frammento</div>
              </div>
              <div class="chev">‚Ä∫</div>
            </a>
          </div>

          <a href="testi/gelsomino-notturno.html" aria-label="Vai a Il gelsomino notturno">
            <div>
              <div class="label">I testi ‚Äî Il gelsomino notturno</div>
              <div class="sub">una poesia, un mondo</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="testi/x-agosto.html" aria-label="Vai a X agosto">
            <div>
              <div class="label">I testi ‚Äî X agosto</div>
              <div class="sub">la ferita e il grido</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="testi/digitale-purpurea.html" aria-label="Vai a Digitale purpurea">
            <div>
              <div class="label">I testi ‚Äî Digitale purpurea</div>
              <div class="sub">proibito, simbolo, ombra</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>

          <a href="#spirit" aria-label="Vai a Spirito dell‚Äôopera">
            <div>
              <div class="label">Spirito dell‚Äôopera</div>
              <div class="sub">patto di lettura</div>
            </div>
            <div class="chev">‚Ä∫</div>
          </a>
        </div>
      </aside>

      <!-- RIGHT / STAGE -->
      <section class="stage" aria-label="Immagine di Pascoli">
        <div class="hint">clic sull‚Äôimmagine: ‚Äúeco di Pascoli‚Äù</div>

        <!-- PORTRAIT -->
        <div id="panelPortrait" class="panel portrait" role="img" aria-label="Ritratto di Pascoli">
          <div class="overlay">
            <button id="btnEcho" class="btn" type="button" aria-label="Mostra l‚Äôeco di Pascoli">
              ‚ñ∂Ô∏é Ascolta l‚Äôeco di Pascoli
            </button>
            <div class="note">
              (Qui puoi anche sostituire l‚Äôeco con un tuo audio/video: ora √® un segnaposto coerente.)
            </div>
          </div>
        </div>

        <!-- ECHO -->
        <div id="panelEcho" class="panel echo hidden" aria-label="Eco di Pascoli">
          <div class="frame">
            <h3>Eco</h3>
            <div class="who">Pascoli (non in posa)</div>
            <p>
              Non sono il poeta della quiete. Sono il poeta di un mondo che scricchiola.
              Il ‚Äúfanciullino‚Äù non √® un bambino felice: √® una percezione senza difese.
              Io sento troppo. E dove gli altri mettono un senso, io sento un segno.
            </p>
            <p>
              Se ti sembra semplice, √® perch√© la lingua √® costretta: paratassi, frammenti, suoni.
              Non √® stile carino. √à limite.
            </p>

            <div class="tools">
              <button class="pillbtn" id="btnSpeak" type="button" aria-label="Leggi a voce (se disponibile)">üîä Voce</button>
              <button class="pillbtn" id="btnStop" type="button" aria-label="Ferma voce">‚èπ Stop</button>
              <button class="pillbtn" id="btnBack" type="button" aria-label="Torna all‚Äôimmagine">‚Ü©Ô∏é Torna al ritratto</button>
            </div>

            <div class="smallprint">
              Nota: la funzione voce usa il browser (SpeechSynthesis). Se non √® disponibile sul dispositivo, resta solo il testo.
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- SPIRIT -->
    <section id="spirit" class="spirit" aria-label="Spirito dell‚Äôopera">
      <h4>Spirito dell‚Äôopera</h4>
      <p>
        Questa web app non chiede di andare sempre pi√π a fondo. Chiede di sapere <b>quando fermarsi</b> e <b>quando scegliere di scendere</b>.
        Qui trovi un percorso essenziale (vita ‚Üí sguardo ‚Üí poetica ‚Üí testi), e poi approfondimenti mirati: niente labirinti.
      </p>
    </section>

    <footer>
      ¬© <span id="year"></span> ‚Äî Pascoli / Libro.0 ‚Äî a cura di gbprof
    </footer>
  </div>

  <!-- MODAL: Bussola della frase (si apre cliccando la frase) -->
  <div id="modal" class="modal" hidden aria-hidden="true">
    <div class="backdrop" id="backdrop"></div>
    <div class="dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="dh">
        <strong>Bussola</strong>
        <button class="x" id="closeModal" type="button" aria-label="Chiudi">‚úï</button>
      </div>
      <div class="db">
        <h3 id="modalTitle">Io non sono mai cresciuto</h3>
        <p>
          Qui ‚Äúnon crescere‚Äù non √® nostalgia n√© purezza. √à una cosa pi√π dura: <b>restare esposti</b>.
          Pascoli non si difende: registra il mondo come insieme di segni (rumori, oggetti, presagi) e la poesia nasce dal limite.
        </p>
        <ul>
          <li><b>Non √® infantile</b>: √® ipersensibile.</li>
          <li><b>Non consola</b>: sospende, inquieta, fa vedere.</li>
          <li><b>La forma</b> (paratassi, frammento) non √® vezzo: √® necessit√†.</li>
        </ul>
        <p>
          Questa bussola regge tutto il percorso: <b>Vita</b> (frattura) ‚Üí <b>Immagine del mondo</b> (sguardo) ‚Üí <b>Poetica</b> (linguaggio) ‚Üí <b>Testi</b> (verifica).
        </p>
        <div class="row">
          <a class="linkbtn" href="vita.html">Vai a ‚ÄúLa vita‚Äù</a>
          <a class="linkbtn" href="mondo.html">Vai a ‚ÄúImmagine del mondo‚Äù</a>
          <a class="linkbtn" href="poetica.html">Vai a ‚ÄúPoetica‚Äù</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const $ = (q, root=document) => root.querySelector(q);

    // year
    $('#year').textContent = new Date().getFullYear();

    // phrase: load/save editable content
    const phraseEl = $('#phrase');
    const LS_KEY = 'pascoli_home_phrase_v1';

    const loadPhrase = () => {
      const saved = localStorage.getItem(LS_KEY);
      if(saved && saved.trim()) phraseEl.textContent = saved;
    };

    const savePhrase = () => {
      const txt = (phraseEl.textContent || '').trim();
      if(txt) localStorage.setItem(LS_KEY, txt);
    };

    loadPhrase();

    phraseEl.addEventListener('input', savePhrase);
    phraseEl.addEventListener('blur', savePhrase);

    // click on phrase => modal bussola
    const modal = $('#modal');
    const backdrop = $('#backdrop');
    const closeBtn = $('#closeModal');
    const modalTitle = $('#modalTitle');

    const openModal = () => {
      const t = (phraseEl.textContent || '').trim();
      modalTitle.textContent = t || 'Io non sono mai cresciuto';
      modal.hidden = false;
      modal.setAttribute('aria-hidden', 'false');
    };

    const closeModal = () => {
      modal.hidden = true;
      modal.setAttribute('aria-hidden', 'true');
    };

    // IMPORTANT: contenteditable eats clicks.
    // We open the modal on double-click or on click when not editing.
    // To keep it simple: single click opens if selection length == 0 AND not currently editing.
    let isEditing = false;
    phraseEl.addEventListener('focus', () => { isEditing = true; });
    phraseEl.addEventListener('blur', () => { isEditing = false; });

    phraseEl.addEventListener('click', (e) => {
      // if the user is clearly editing, don't hijack.
      if(isEditing) return;
      // open when not selecting text
      const sel = window.getSelection();
      if(sel && sel.toString().length > 0) return;
      openModal();
    });

    // fallback: double click always opens
    phraseEl.addEventListener('dblclick', (e) => { e.preventDefault(); openModal(); });

    backdrop.addEventListener('click', closeModal);
    closeBtn.addEventListener('click', closeModal);
    document.addEventListener('keydown', (e) => { if(!modal.hidden && e.key === 'Escape') closeModal(); });

    // Image ‚Üî Echo toggle
    const panelPortrait = $('#panelPortrait');
    const panelEcho = $('#panelEcho');
    const btnEcho = $('#btnEcho');
    const btnBack = $('#btnBack');

    const showEcho = () => {
      panelPortrait.classList.add('hidden');
      panelEcho.classList.remove('hidden');
    };

    const showPortrait = () => {
      panelEcho.classList.add('hidden');
      panelPortrait.classList.remove('hidden');
      stopSpeak();
    };

    btnEcho.addEventListener('click', showEcho);
    btnBack.addEventListener('click', showPortrait);

    // Voice (optional)
    const speakBtn = $('#btnSpeak');
    const stopBtn = $('#btnStop');

    const textToSpeak = () => {
      const frame = panelEcho.querySelector('.frame');
      const paragraphs = Array.from(frame.querySelectorAll('p')).map(p => p.textContent.trim());
      return paragraphs.join(' ');
    };

    const canSpeak = () => ('speechSynthesis' in window) && typeof SpeechSynthesisUtterance !== 'undefined';

    const stopSpeak = () => {
      if(canSpeak()) window.speechSynthesis.cancel();
    };

    const doSpeak = () => {
      if(!canSpeak()) return;
      stopSpeak();
      const u = new SpeechSynthesisUtterance(textToSpeak());
      u.lang = 'it-IT';
      u.rate = 0.95;
      u.pitch = 1.0;
      window.speechSynthesis.speak(u);
    };

    speakBtn.addEventListener('click', doSpeak);
    stopBtn.addEventListener('click', stopSpeak);

    // If voice not available, visually disable
    if(!canSpeak()){
      speakBtn.disabled = true;
      speakBtn.textContent = 'üîä Voce (non disponibile)';
      speakBtn.style.opacity = 0.55;
      speakBtn.style.cursor = 'not-allowed';
    }
  </script>
</body>
</html>
