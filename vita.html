<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pascoli ‚Äî La vita</title>

<style>
:root{
  --bg1:#fbf7ef;
  --bg2:#e9f6ff;
  --ink:#1f2a33;
  --card:rgba(255,255,255,.8);
  --hl:rgba(255,183,3,.3);
  --ul:rgba(33,158,188,.8);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(180deg,var(--bg2),var(--bg1));
  color:var(--ink);
}

.wrap{max-width:1100px;margin:auto;padding:20px}

h1{margin:.3em 0}

.card{
  background:var(--card);
  border-radius:20px;
  padding:16px;
  box-shadow:0 10px 40px rgba(0,0,0,.12);
}

/* üîí BLOCCO TOTALE SELEZIONE iOS */
.prose,
.block,
.block *{
  user-select:none;
  -webkit-user-select:none;
  -webkit-touch-callout:none;
}

/* blocchi */
.block{
  padding:12px;
  margin-bottom:10px;
  border-radius:14px;
  background:rgba(255,255,255,.7);
  cursor:pointer;
  transition:.15s;
}

.block:hover{background:rgba(255,255,255,.9)}
.block.selected{outline:2px solid rgba(255,183,3,.5)}

.block[data-mark="hl"]{
  background:linear-gradient(0deg,var(--hl),var(--hl)),rgba(255,255,255,.8)
}
.block[data-mark="ul"]{
  text-decoration:underline;
  text-decoration-thickness:3px;
  text-decoration-color:var(--ul);
  text-underline-offset:4px;
}

/* toolbar */
#floating{
  position:absolute;
  display:none;
  gap:6px;
  background:white;
  padding:8px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.2);
  z-index:10;
}

button{
  border:none;
  border-radius:999px;
  padding:8px 12px;
  font-weight:700;
  cursor:pointer;
}

/* quaderno */
#notebook{
  margin-top:16px;
  padding:12px;
  background:white;
  border-radius:16px;
}

#notebookText{
  white-space:pre-wrap;
  font-size:13px;
  margin-top:8px;
}
</style>
</head>

<body>
<div class="wrap">

<h1>Pascoli ‚Äî La vita</h1>

<div class="card prose" id="workArea">

  <div class="block" data-id="b1">
    Giovanni Pascoli nasce a San Mauro di Romagna nel 1855. L‚Äôinfanzia viene spezzata
    dall‚Äôassassinio del padre Ruggero (10 agosto 1867).
  </div>

  <div class="block" data-id="b2">
    Studia a Bologna con Carducci. Gli anni universitari sono agitati: politica,
    perdita della borsa di studio, carcere.
  </div>

  <div class="block" data-id="b3">
    Vive con le sorelle. Il matrimonio di Ida √® vissuto come un abbandono:
    non √® sentimento, √® struttura psicologica.
  </div>

</div>

<!-- toolbar -->
<div id="floating">
  <button id="ul">‚úèÔ∏è</button>
  <button id="hl">üñçÔ∏è</button>
  <button id="pin">üìå</button>
  <button id="clear">‚úï</button>
</div>

<!-- quaderno -->
<div id="notebook" class="card">
  <b>Quaderno</b>
  <div id="notebookText"></div>
  <button id="copy">Copia</button>
  <button id="save">Salva .txt</button>
</div>

</div>

<script>
const blocks=[...document.querySelectorAll('.block')]
const floating=document.getElementById('floating')
let selected=null
let notebook=[]

blocks.forEach(b=>{
  b.addEventListener('click',e=>{
    blocks.forEach(x=>x.classList.remove('selected'))
    selected=b
    b.classList.add('selected')

    const r=b.getBoundingClientRect()
    floating.style.top=window.scrollY+r.bottom+6+'px'
    floating.style.left=r.left+'px'
    floating.style.display='flex'
  })
})

document.getElementById('ul').onclick=()=>mark('ul')
document.getElementById('hl').onclick=()=>mark('hl')
document.getElementById('clear').onclick=()=>mark(null)

function mark(type){
  if(!selected)return
  if(type) selected.dataset.mark=type
  else delete selected.dataset.mark
}

document.getElementById('pin').onclick=()=>{
  if(!selected)return
  const t=selected.textContent.trim()
  if(!notebook.includes(t)){
    notebook.push(t)
    renderNotebook()
  }
}

function renderNotebook(){
  document.getElementById('notebookText').textContent=notebook.join('\n')
}

document.getElementById('copy').onclick=()=>{
  navigator.clipboard.writeText(notebook.join('\n'))
}

document.getElementById('save').onclick=()=>{
  const blob=new Blob([notebook.join('\n')],{type:'text/plain'})
  const a=document.createElement('a')
  a.href=URL.createObjectURL(blob)
  a.download='pascoli_vita.txt'
  a.click()
}
</script>

</body>
</html>
